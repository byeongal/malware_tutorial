import pefile
from datetime import datetime

# AhnLab-V3 : Trojan/Win32.WannaCryptor.R200571
# ALYac : Trojan.Ransom.WannaCryptor
file_path = r"E:\malware\KFTC2020_Samples\84c82835a5d21bbcf75a61706d8ab549.vir"

pe = pefile.PE(file_path)

print('Machine : 0x{:04X}({})'.format(pe.FILE_HEADER.Machine, pefile.MACHINE_TYPE[pe.FILE_HEADER.Machine]))
print('Number of Sections : 0x{:04X}'.format(pe.FILE_HEADER.NumberOfSections))
print('Time Date Stamp : 0x{:08X}({})'.format(
    pe.FILE_HEADER.TimeDateStamp,
    datetime.fromtimestamp(pe.FILE_HEADER.TimeDateStamp).strftime('%Y/%m/%d %H:%M:%S UTC')))
print('Pointer to Symbol Table : 0x{:08X}'.format(pe.FILE_HEADER.PointerToSymbolTable))
print('Number of Symbols : 0x{:08X}'.format(pe.FILE_HEADER.NumberOfSymbols))
print('Size of Optional Header : 0x{:04X}'.format(pe.FILE_HEADER.SizeOfOptionalHeader))
print('Characteristics : 0x{:04X}'.format(pe.FILE_HEADER.Characteristics))
for value, description in pefile.image_characteristics:
    if pe.FILE_HEADER.Characteristics & description == description:
        print('- 0x{:04X}\t{}'.format(description, value))