import pefile

# AhnLab-V3 : Trojan/Win32.WannaCryptor.R200571
# ALYac : Trojan.Ransom.WannaCryptor
file_path = r"./samples/84c82835a5d21bbcf75a61706d8ab549.vir"

pe = pefile.PE(file_path)

for section in pe.sections:
    try:
        section_name = str(section.Name, 'utf-8').encode('ascii', errors='ignore').strip().decode('ascii')
    except:
        section_name = str(section.Name, 'ISO-8859-1').encode('ascii', errors='ignore').strip().decode('ascii')
    section_name = section_name.replace('\u0000', '')
    if section_name == '':
        section_name = '.noname'
    print('Name :', section_name)
    print('Virtual Size :', '0x{:08X}'.format(section.Misc_VirtualSize))
    print('RVA :', '0x{:08X}'.format(section.VirtualAddress))
    print('Size of Raw Data :', '0x{:08X}'.format(section.SizeOfRawData))
    print('Pointer to Raw Data :', '0x{:08X}'.format(section.PointerToRawData))
    print('Pointer to Line Numbers :', '0x{:08X}'.format(section.PointerToLinenumbers))
    print('Number of Relocations :', '0x{:04X}'.format(section.NumberOfRelocations))
    print('Number of Line Numbers :', '0x{:04X}'.format(section.NumberOfLinenumbers))
    print('Characteristics :', '0x{:08X}'.format(section.Characteristics))
    for value, description in pefile.section_characteristics[1:]:
        if section.Characteristics & description == description:
            print('- 0x{:08X}\t{}'.format(description, value))
    print()